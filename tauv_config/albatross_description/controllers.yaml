# controllers.yaml
# This is a rosparam yaml that is intended to parameterize the control aggregator node.
# Should be loaded into the "/(model_name)/controllers/configs" namespace.
# Author: Tom Scherlis

# Just a handy reference to the model name for tf quickery.
model_name: "albatross"

# List of the controllers available on the vehicle, and default enable status:
# Names of controllers must be consistent with their subnamespace within the controllers namespace.
controllers:
  keyboard:
    enabled: true
  cascaded_controller:
    enabled: true

# Topic suffix: this will be appended to the "(controller_name)" namespace to find the output
# topic containing the force wrench from that controller. Eg, if the controller is called
# keyboard, then this will look at keyboard{topic_suffix} for the output wrench.
# Should likely start with a leading slash.
topic_suffix: "/wrench"

# Output frame. All wrench data will be published with respect to this frame. There must
# exist a tf connection between the output_frame and any frame_ids of input wrenches.
output_frame: "albatross/base_link"

# Timout_s: Control inputs will be "remembered" for this long, before being reset to zero if no
# data is received.
timeout_s: 1.0

# Output topic to publish the resultant wrench to.
output_topic: "/albatross/thruster_manager/input_stamped"


# Individual Controller Configurations:

# Cascaded Controller:
cascaded_controller:
  input_topic: "input"
  output_topic: "wrench"
  velocity_averaging_interval: 0.1

  pids:
    pos_roll_controller:
      Kp: 30
      Kd: 0
      Ki: .5
      upper_limit: 20
      lower_limit: -20
      windup_limit: 20
      topic_from_controller: "pos_roll_effort"
      topic_from_plant: "pos_roll_state"
      setpoint_topic: "pos_roll_setpoint"
      error_topic: "pos_roll_error"
      node_name: "pos_roll_controller"
      angle_error: false
      use_error: true

    pos_pitch_controller:
      Kp: 30
      Kd: 0
      Ki: .5
      upper_limit: 20
      lower_limit: -20
      windup_limit: 20
      topic_from_controller: "pos_pitch_effort"
      topic_from_plant: "pos_pitch_state"
      setpoint_topic: "pos_pitch_setpoint"
      error_topic: "pos_pitch_error"
      node_name: "pos_pitch_controller"
      angle_error: false
      use_error: true

    pos_yaw_controller:
      Kp: 5
      Kd: 1
      Ki: 0.1
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "pos_yaw_effort"
      topic_from_plant: "pos_yaw_state"
      setpoint_topic: "pos_yaw_setpoint"
      error_topic: "pos_yaw_error"
      node_name: "pos_yaw_controller"
      angle_error: false
      use_error: true

    pos_x_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 100
      lower_limit: -100
      windup_limit: 0.5
      topic_from_controller: "pos_x_effort"
      topic_from_plant: "pos_x_state"
      setpoint_topic: "pos_x_setpoint"
      node_name: "pos_x_controller"

    pos_y_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 100
      lower_limit: -100
      windup_limit: 0.5
      topic_from_controller: "pos_y_effort"
      topic_from_plant: "pos_y_state"
      setpoint_topic: "pos_y_setpoint"
      node_name: "pos_y_controller"

    pos_z_controller:
      Kp: 30
      Kd: 0
      Ki: 0
      upper_limit: 100
      lower_limit: -100
      windup_limit: 0.5
      topic_from_controller: "pos_z_effort"
      topic_from_plant: "pos_z_state"
      setpoint_topic: "pos_z_setpoint"
      node_name: "pos_z_controller"

    vel_roll_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_roll_effort"
      topic_from_plant: "vel_roll_state"
      setpoint_topic: "vel_roll_setpoint"
      node_name: "vel_roll_controller"

    vel_pitch_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_pitch_effort"
      topic_from_plant: "vel_pitch_state"
      setpoint_topic: "vel_pitch_setpoint"
      node_name: "vel_pitch_controller"

    vel_yaw_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_yaw_effort"
      topic_from_plant: "vel_yaw_state"
      setpoint_topic: "vel_yaw_setpoint"
      node_name: "vel_yaw_controller"

    vel_x_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_x_effort"
      topic_from_plant: "vel_x_state"
      setpoint_topic: "vel_x_setpoint"
      node_name: "vel_x_controller"

    vel_y_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_y_effort"
      topic_from_plant: "vel_y_state"
      setpoint_topic: "vel_y_setpoint"
      node_name: "vel_y_controller"

    vel_z_controller:
      Kp: 10
      Kd: 0
      Ki: 0
      upper_limit: 20
      lower_limit: -20
      windup_limit: 0.5
      topic_from_controller: "vel_z_effort"
      topic_from_plant: "vel_z_state"
      setpoint_topic: "vel_z_setpoint"
      node_name: "vel_z_controller"